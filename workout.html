<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="pictures/5.jpg">
    <title>Workouts</title>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style type="text/tailwindcss">
        :root {
        --dark-bg: #111111;
        --fiery-red: #ff3838;
        --fiery-red-bg: #ff38380e;
        --fiery-orange: #ff914d;
        --card-bg: #1a1a1a;
      }
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: "Montserrat", sans-serif;
      }
      .font-poppins {
        font-family: "Poppins", sans-serif;
      }
      .container {
        width: 100%;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        padding-bottom: 100px;
      }
      .card {
        width: 100%;
        max-width: 600px;
        min-height: 100vh;
        border-radius: 10px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }
      .This-week {
        background: linear-gradient(to right,var(--fiery-red),var(--fiery-orange));
      }
      .nav {
        position: fixed;
        bottom: 0;
        width: 100%;
        max-width: 600px;
        left: 50%;
        transform: translateX(-50%);
      }
      .nav-link {
        transition: .3s linear;
      }
      .nav-link:hover {
        background-color: #ff383813;
      }
      .nav-link {
        border-radius: 10px;
      }
      .daily-summary {
        background: linear-gradient(to right, var(--fiery-red), var(--fiery-orange));
      }

      input[type="checkbox"] {
        display: none; /* hide default checkbox */
      }

      .checkbox {
        width: 17px;
        height: 17px;
        border: 1px solid #ccc;
        border-radius: 2px;
        position: relative;
        cursor: pointer;
        transition: border 0.3s ease;
      }

      .checkbox:hover {
        border: 1px solid var(--fiery-red);
      }

      /* Hide checkmark by default */
      .checkbox::before {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 10px;
        color: white;
        width: 0px;
        height: 0px;
        background: transparent;
        border-radius: 2px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        transition: all 0.3s linear;
      }

      /* Show checkmark when checked */
      input[type="checkbox"]:checked + .checkbox::before {
        content: "\f00c"; /* check icon */
        background: var(--fiery-red);
        transform: translate(-50%, -50%) rotate(360deg);
        width: 15px;
        height: 15px;
      }

      input[type="checkbox"]:checked + .checkbox {
        border: none;
      }

      .completed-span {
        transition: opacity 0.3s ease;
      }

      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.8);
      }
      .modal.show {
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .modal-content {
        background-color: var(--card-bg);
        margin: 15% auto;
        padding: 20px;
        border-radius: 10px;
        width: 90%;
        max-width: 400px;
        position: relative;
      }
      .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        position: absolute;
        right: 15px;
        top: 10px;
      }
      .close:hover,
      .close:focus {
        color: var(--fiery-red);
        text-decoration: none;
        cursor: pointer;
      }
    </style>
</head>
<body class="bg-[var(--dark-bg)] text-white antialiased scroll-smooth">
    <div class="container">
        <div class="card bg-[var(--card-bg)] p-5">
            <div class="head flex items-center justify-between mb-6">
                <div>
                    <h1 class="font-poppins text-2xl font-bold text-[var(--fiery-orange)]">Workouts</h1>
                </div>
            </div>
            
            <div class="calories-card bg-[var(--dark-bg)] p-6 rounded-lg w-full mb-5">
                <h2 class="font-poppins text-xl">Today's Session</h2>
                
                <!-- Task items will be inserted here -->
                <div class="task-items">
                    <!-- Tasks will be dynamically added here -->
                </div>
                
                <div class="bg-green-100 rounded-xl p-3 mt-4 congrats-message hidden">
                    <p class="text-green-700 text-sm">Great job! You have completed all today's workouts</p>
                </div>
                
                <div class="flex items-center mt-3 gap-2 text-[var(--fiery-red)] cursor-pointer add-task-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus w-4 h-4"><path d="M5 12h14"></path><path d="M12 5v14"></path></svg>
                    <span>Add Task</span>
                </div>
            </div>

            <div class="calories-card bg-[var(--dark-bg)] p-6 rounded-lg w-full mb-5">
                <div class="top flex items-center justify-between w-full mb-3">
                    <h2 class="font-poppins text-xl">Upcoming</h2>
                </div>
                
                <!-- Upcoming tasks will be inserted here -->
                <div class="upcoming-tasks">
                    <!-- Upcoming tasks will be dynamically added here -->
                </div>

                <div class="flex items-center justify-between mt-4">
                    <div class="flex items-center gap-2 text-[var(--fiery-red)] cursor-pointer add-upcoming-task-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus w-4 h-4"><path d="M5 12h14"></path><path d="M12 5v14"></path></svg>
                        <span>Add Task</span>
                    </div>
                    <button class="text-gray-400 hover:text-red-500 text-sm transition-colors reset-upcoming-btn">Reset</button>
                </div>
            </div>

            <!-- Weekly Progress -->
            <div class="This-week p-6 rounded-lg w-full mt-6 mb-6">
              <h1 class="font-poppins mb-5 text-2xl">This Week's Progress</h1>
              <div class="pr-4 pl-4">
                <div class="flex items-center justify-between">
                  <div class="flex items-center justify-center flex-col font-poppins">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trending-up w-6 h-6 mx-auto mb-1"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"></polyline><polyline points="16 7 22 7 22 13"></polyline></svg>
                    <span class="text-2xl font-bold completed-workouts-count">0</span>
                    <span>Workouts</span>
                  </div>
                  <div class="flex items-center justify-center flex-col font-poppins">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-target w-6 h-6 mx-auto mb-1"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle></svg>
                    <span class="text-2xl font-bold total-minutes">0</span>
                    <span>Minutes</span>
                  </div>
                  <div class="flex items-center justify-center flex-col font-poppins">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-zap w-6 h-6 mx-auto mb-1"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>
                    <span class="text-2xl font-bold calories-burned">0</span>
                    <span>Calories</span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Reset Button -->
            <div class="reset-btn flex justify-center mb-5">
                <button class="bg-[var(--fiery-red)] text-white py-2 px-4 rounded hover:opacity-90 transition-opacity">Reset Day</button>
            </div>
        </div>
    </div>

    <!-- Add Task Modal for Today's Session -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 class="text-xl font-bold text-[var(--fiery-orange)] mb-4">Add Workout Task</h2>
            <form id="taskForm">
                <div class="mb-4">
                    <label for="taskName" class="block text-sm font-medium mb-2">Exercise Name</label>
                    <input type="text" id="taskName" class="w-full p-3 rounded bg-[var(--dark-bg)] text-white border border-gray-600 focus:border-[var(--fiery-orange)] outline-none" placeholder="e.g., Push ups, Running, Squats" required>
                </div>
                <div class="mb-4">
                    <label for="taskDuration" class="block text-sm font-medium mb-2">Duration (minutes)</label>
                    <input type="number" id="taskDuration" class="w-full p-3 rounded bg-[var(--dark-bg)] text-white border border-gray-600 focus:border-[var(--fiery-orange)] outline-none" placeholder="30" min="1" required>
                </div>
                <div class="flex gap-3">
                    <button type="submit" class="flex-1 bg-gradient-to-r from-[var(--fiery-red)] to-[var(--fiery-orange)] text-white py-2 px-4 rounded hover:opacity-90 transition-opacity">
                        Add Task
                    </button>
                    <button type="button" id="cancelBtn" class="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Upcoming Task Modal -->
    <div id="upcomingTaskModal" class="modal">
        <div class="modal-content">
            <span class="close-upcoming">&times;</span>
            <h2 class="text-xl font-bold text-[var(--fiery-orange)] mb-4">Add Upcoming Task</h2>
            <form id="upcomingTaskForm">
                <div class="mb-4">
                    <label for="upcomingTaskName" class="block text-sm font-medium mb-2">Exercise Name</label>
                    <input type="text" id="upcomingTaskName" class="w-full p-3 rounded bg-[var(--dark-bg)] text-white border border-gray-600 focus:border-[var(--fiery-orange)] outline-none" placeholder="e.g., Yoga, Strength Training" required>
                </div>
                <div class="mb-4">
                    <label for="upcomingTaskDuration" class="block text-sm font-medium mb-2">Duration (minutes)</label>
                    <input type="number" id="upcomingTaskDuration" class="w-full p-3 rounded bg-[var(--dark-bg)] text-white border border-gray-600 focus:border-[var(--fiery-orange)] outline-none" placeholder="30" min="1" required>
                </div>
                <div class="mb-4">
                    <label for="upcomingTaskDay" class="block text-sm font-medium mb-2">Day</label>
                    <input type="text" id="upcomingTaskDay" class="w-full p-3 rounded bg-[var(--dark-bg)] text-white border border-gray-600 focus:border-[var(--fiery-orange)] outline-none" placeholder="e.g., Tomorrow, Thursday" required>
                </div>
                <div class="flex gap-3">
                    <button type="submit" class="flex-1 bg-gradient-to-r from-[var(--fiery-red)] to-[var(--fiery-orange)] text-white py-2 px-4 rounded hover:opacity-90 transition-opacity">
                        Add Task
                    </button>
                    <button type="button" id="cancelUpcomingBtn" class="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- NAVBAR -->
    <div class="nav bg-[var(--dark-bg)] p-4 z-50">
        <div class="flex items-center justify-between px-4 gap-2">
            <a href="https://trainwithmohamed.github.io/my-fitness-website/home.html">
                <div class="nav-link text-gray-400 flex items-center justify-center flex-col font-poppins rounded p-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-home w-6 h-6 mb-1"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                    <span class="text-xs">Home</span>
                </div>
            </a>
            <a href="https://trainwithmohamed.github.io/my-fitness-website/meals.html">
                <div class="nav-link flex text-gray-400 items-center justify-center flex-col font-poppins p-2 rounded">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-utensils w-6 h-6 mb-1"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"></path><path d="M7 2v20"></path><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"></path></svg>
                    <span class="text-xs">Meals</span>
                </div>
            </a>
            <a href="https://trainwithmohamed.github.io/my-fitness-website/water.html">
                <div class="nav-link text-gray-400 flex items-center justify-center flex-col font-poppins rounded p-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-droplets w-6 h-6 mb-1"><path d="M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z"></path><path d="M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97"></path></svg>
                <span class="text-xs">Water</span>
            </div>
        </a>
        <a href="https://trainwithmohamed.github.io/my-fitness-website/workout.html">
            <div class="nav-link text-gray-400 flex items-center justify-center flex-col font-poppins rounded p-2 bg-[var(--fiery-red-bg)]">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-dumbbell w-6 h-6 mb-1 text-[var(--fiery-red)]"><path d="M14.4 14.4 9.6 9.6"></path><path d="M18.657 21.485a2 2 0 1 1-2.829-2.828l-1.767 1.768a2 2 0 1 1-2.829-2.829l6.364-6.364a2 2 0 1 1 2.829 2.829l-1.768 1.767a2 2 0 1 1 2.828 2.829z"></path><path d="m21.5 21.5-1.4-1.4"></path><path d="M3.9 3.9 2.5 2.5"></path><path d="M6.404 12.768a2 2 0 1 1-2.829-2.829l1.768-1.767a2 2 0 1 1-2.828-2.829l2.828-2.828a2 2 0 1 1 2.829 2.828l1.767-1.768a2 2 0 1 1 2.829 2.829z"></path></svg>
                <span class="text-xs text-[var(--fiery-red)]">Workout</span>
            </div>
        </a>
    </div>
</div>
<script>
// Load workout data from localStorage or initialize if not exists
let workoutData = JSON.parse(localStorage.getItem('workoutData'));

if (!workoutData) {
    workoutData = {
        tasks: [
            { id: 1, name: 'Cardio', duration: 30, completed: false }
        ],
        upcomingTasks: [
            { id: 1, name: 'Strength Training', duration: 45, day: 'Tomorrow' },
            { id: 2, name: 'Yoga Session', duration: 30, day: 'Thursday' }
        ]
    };
    localStorage.setItem('workoutData', JSON.stringify(workoutData));
}

// Load weekly progress separately - independent from daily tasks
let weeklyProgress = JSON.parse(localStorage.getItem('weeklyProgress'));

if (!weeklyProgress) {
    weeklyProgress = {
        completedWorkouts: 0,
        totalMinutes: 0,
        caloriesBurned: 0,
        resetCount: 0 // Track how many times reset button was clicked
    };
    localStorage.setItem('weeklyProgress', JSON.stringify(weeklyProgress));
}

// Modal elements
const modal = document.getElementById('taskModal');
const form = document.getElementById('taskForm');
const taskNameInput = document.getElementById('taskName');
const taskDurationInput = document.getElementById('taskDuration');
const closeBtn = document.querySelector('.close');
const cancelBtn = document.getElementById('cancelBtn');
const addTaskBtn = document.querySelector('.add-task-btn');
const resetBtn = document.querySelector('.reset-btn button');

// Upcoming modal elements
const upcomingModal = document.getElementById('upcomingTaskModal');
const upcomingForm = document.getElementById('upcomingTaskForm');
const upcomingTaskNameInput = document.getElementById('upcomingTaskName');
const upcomingTaskDurationInput = document.getElementById('upcomingTaskDuration');
const upcomingTaskDayInput = document.getElementById('upcomingTaskDay');
const closeUpcomingBtn = document.querySelector('.close-upcoming');
const cancelUpcomingBtn = document.getElementById('cancelUpcomingBtn');
const addUpcomingTaskBtn = document.querySelector('.add-upcoming-task-btn');
const resetUpcomingBtn = document.querySelector('.reset-upcoming-btn');

// Add event listeners
addTaskBtn.addEventListener('click', openModal);
addUpcomingTaskBtn.addEventListener('click', openUpcomingModal);

// Today's session modal functions
function openModal() {
    modal.classList.add('show');
    taskNameInput.value = '';
    taskDurationInput.value = '';
}

function closeModal() {
    modal.classList.remove('show');
}

closeBtn.onclick = closeModal;
cancelBtn.onclick = closeModal;

// Upcoming modal functions
function openUpcomingModal() {
    upcomingModal.classList.add('show');
    upcomingTaskNameInput.value = '';
    upcomingTaskDurationInput.value = '';
    upcomingTaskDayInput.value = '';
}

function closeUpcomingModal() {
    upcomingModal.classList.remove('show');
}

closeUpcomingBtn.onclick = closeUpcomingModal;
cancelUpcomingBtn.onclick = closeUpcomingModal;

window.onclick = function(event) {
    if (event.target == modal) {
        closeModal();
    }
    if (event.target == upcomingModal) {
        closeUpcomingModal();
    }
}

// Form submissions
form.addEventListener('submit', (e) => {
    e.preventDefault();
    const taskName = taskNameInput.value.trim();
    const duration = parseInt(taskDurationInput.value);
    
    if (!taskName || !duration) return;

    addNewTask(taskName, duration);
    closeModal();
});

upcomingForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const taskName = upcomingTaskNameInput.value.trim();
    const duration = parseInt(upcomingTaskDurationInput.value);
    const day = upcomingTaskDayInput.value.trim();
    
    if (!taskName || !duration || !day) return;

    addNewUpcomingTask(taskName, duration, day);
    closeUpcomingModal();
});

// Add new task to today's session
function addNewTask(name, duration) {
    const newTask = {
        id: Date.now(),
        name: name,
        duration: duration,
        completed: false
    };
    
    workoutData.tasks.push(newTask);
    localStorage.setItem('workoutData', JSON.stringify(workoutData));
    
    updateTasksDisplay();
    checkAllTasksCompleted();
}

// Add new upcoming task
function addNewUpcomingTask(name, duration, day) {
    const newTask = {
        id: Date.now(),
        name: name,
        duration: duration,
        day: day
    };
    
    workoutData.upcomingTasks.push(newTask);
    localStorage.setItem('workoutData', JSON.stringify(workoutData));
    
    updateUpcomingTasksDisplay();
}

// Update today's tasks display
function updateTasksDisplay() {
    const taskItems = document.querySelector('.task-items');
    taskItems.innerHTML = '';

    if (workoutData.tasks.length === 0) {
        taskItems.innerHTML = '<p class="text-gray-400 mt-2">No tasks added yet</p>';
        return;
    }

    workoutData.tasks.forEach(task => {
        const taskDiv = document.createElement('div');
        taskDiv.className = 'flex items-center justify-between mt-3 gap-2';
        taskDiv.innerHTML = `
            <div class="flex items-center mt-3 gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-check-big w-6 h-6 text-green-500"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg>
                <div>
                    <span class="text-[var(--fiery-red)]">${task.name}</span>
                    <p class="text-gray-400">${task.duration} minutes <span class="completed-span ${task.completed ? 'opacity-100' : 'opacity-0'}">• Completed</span></p>
                </div>
            </div>
            <label>
                <input type="checkbox" ${task.completed ? 'checked' : ''} data-task-id="${task.id}">
                <div class="checkbox"></div>
            </label>
        `;
        taskItems.appendChild(taskDiv);
    });

    // Add event listeners to checkboxes
    document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
        checkbox.addEventListener('change', handleTaskComplete);
    });
}

// Update upcoming tasks display
function updateUpcomingTasksDisplay() {
    const upcomingTasksContainer = document.querySelector('.upcoming-tasks');
    upcomingTasksContainer.innerHTML = '';

    if (workoutData.upcomingTasks.length === 0) {
        upcomingTasksContainer.innerHTML = '<p class="text-gray-400">No upcoming tasks</p>';
        return;
    }

    workoutData.upcomingTasks.forEach(task => {
        const taskDiv = document.createElement('div');
        taskDiv.className = 'flex items-center mt-3 gap-2';
        taskDiv.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock w-6 h-6 text-orange-500"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            <div>
                <span class="text-[var(--fiery-red)]">${task.name}</span>
                <p class="text-gray-400">${task.day} • ${task.duration} minutes</p>
            </div>
        `;
        upcomingTasksContainer.appendChild(taskDiv);
    });
}

// Handle task completion - ADD to weekly progress when completed
function handleTaskComplete(event) {
    const taskId = parseInt(event.target.dataset.taskId);
    const task = workoutData.tasks.find(t => t.id === taskId);
    
    if (task) {
        const wasCompleted = task.completed;
        task.completed = event.target.checked;
        
        // Save daily tasks
        localStorage.setItem('workoutData', JSON.stringify(workoutData));
        
        // Update completed span visibility
        const completedSpan = event.target.closest('.flex').querySelector('.completed-span');
        completedSpan.style.opacity = task.completed ? '1' : '0';
        
        // Update weekly progress - ADD or SUBTRACT based on completion
        if (task.completed && !wasCompleted) {
            // Task was just completed - ADD to weekly progress
            weeklyProgress.completedWorkouts += 1;
            weeklyProgress.totalMinutes += task.duration;
            weeklyProgress.caloriesBurned += (task.duration * 5);
        } else if (!task.completed && wasCompleted) {
            // Task was unchecked - SUBTRACT from weekly progress
            weeklyProgress.completedWorkouts = Math.max(0, weeklyProgress.completedWorkouts - 1);
            weeklyProgress.totalMinutes = Math.max(0, weeklyProgress.totalMinutes - task.duration);
            weeklyProgress.caloriesBurned = Math.max(0, weeklyProgress.caloriesBurned - (task.duration * 5));
        }
        
        // Save weekly progress
        localStorage.setItem('weeklyProgress', JSON.stringify(weeklyProgress));
        
        // Update display
        updateWeeklyStatsDisplay();
        checkAllTasksCompleted();
    }
}

// Update weekly statistics display
function updateWeeklyStatsDisplay() {
    document.querySelector('.completed-workouts-count').textContent = weeklyProgress.completedWorkouts;
    document.querySelector('.total-minutes').textContent = weeklyProgress.totalMinutes;
    document.querySelector('.calories-burned').textContent = weeklyProgress.caloriesBurned;
}

// Check if all tasks are completed
function checkAllTasksCompleted() {
    const allCompleted = workoutData.tasks.length > 0 && workoutData.tasks.every(task => task.completed);
    const congratsMessage = document.querySelector('.congrats-message');
    
    if (allCompleted) {
        congratsMessage.classList.remove('hidden');
    } else {
        congratsMessage.classList.add('hidden');
    }
}

// Reset day functionality - tracks reset count, resets weekly progress after 7 resets
resetBtn.addEventListener('click', () => {
    if (confirm("Are you sure you want to reset today's workout tasks?")) {
        // Clear today's tasks (but don't touch weekly progress)
        workoutData.tasks = [];
        localStorage.setItem('workoutData', JSON.stringify(workoutData));

        // Increment reset count
        weeklyProgress.resetCount += 1;
        
        // Check if we've reached 7 resets (7 days)
        if (weeklyProgress.resetCount >= 7) {
            // Reset weekly progress after 7 days
            weeklyProgress = {
                completedWorkouts: 0,
                totalMinutes: 0,
                caloriesBurned: 0,
                resetCount: 0
            };
            
            // Show notification that weekly progress was reset
            alert("Week completed! Weekly progress has been reset.");
        }
        
        // Save weekly progress
        localStorage.setItem('weeklyProgress', JSON.stringify(weeklyProgress));

        updateTasksDisplay();
        updateWeeklyStatsDisplay();
        checkAllTasksCompleted();
    }
});

// Reset upcoming tasks functionality
resetUpcomingBtn.addEventListener('click', () => {
    if (confirm("Are you sure you want to reset all upcoming tasks?")) {
        workoutData.upcomingTasks = [];
        localStorage.setItem('workoutData', JSON.stringify(workoutData));
        updateUpcomingTasksDisplay();
    }
});

// Delete task functionality
function deleteTask(taskId) {
    workoutData.tasks = workoutData.tasks.filter(task => task.id !== taskId);
    localStorage.setItem('workoutData', JSON.stringify(workoutData));
    
    updateTasksDisplay();
    checkAllTasksCompleted();
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', () => {
    updateTasksDisplay();
    updateUpcomingTasksDisplay();
    updateWeeklyStatsDisplay(); // Use the new display function
    checkAllTasksCompleted();
});

// Optional: Add a function to manually reset weekly progress (for testing)
function resetWeeklyProgress() {
    weeklyProgress = {
        completedWorkouts: 0,
        totalMinutes: 0,
        caloriesBurned: 0,
        resetCount: 0
    };
    localStorage.setItem('weeklyProgress', JSON.stringify(weeklyProgress));
    updateWeeklyStatsDisplay();
}

// Optional: Add a function to check current reset count (for debugging)
function checkResetCount() {
    console.log(`Current reset count: ${weeklyProgress.resetCount}/7`);
    return weeklyProgress.resetCount;
}
</script>
</body>

</html>
